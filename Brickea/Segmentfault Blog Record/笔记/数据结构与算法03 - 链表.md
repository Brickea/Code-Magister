# é“¾è¡¨

[å­¦ä¹ å‚è€ƒ](https://pegasuswang.github.io/python_data_structures_and_algorithms/03_%E9%93%BE%E8%A1%A8/linked_list/)

é“¾è¡¨ä¹Ÿæ˜¯å¸¸ç”¨çš„æ•°æ®ç»“æ„

çº¿æ€§ç»“æ„æ•°ç»„çš„ç‰¹ç‚¹ï¼š

* å†…å­˜è¿ç»­
* ä¸‹æ ‡è®¿é—®

éçº¿æ€§ç»“æ„çš„é“¾è¡¨ç‰¹ç‚¹ï¼š

* å†…å­˜ä¸è¿ç»­
* æ²¡æœ‰ä¸‹æ ‡
* æ— è®ºæ˜¯```append``` è¿˜æ˜¯ ```find``` éƒ½éœ€è¦éå†

## å•é“¾è¡¨

è¿™é‡Œå¯ä¸è¦æ··æ·†äº†åˆ—è¡¨å’Œé“¾è¡¨ï¼ˆå®ƒä»¬çš„ä¸­æ–‡å‘éŸ³ç±»ä¼¼ï¼Œä½†æ˜¯åˆ—è¡¨ list åº•å±‚å…¶å®è¿˜æ˜¯çº¿æ€§ç»“æ„ï¼Œé“¾è¡¨æ‰æ˜¯çœŸçš„é€šè¿‡æŒ‡é’ˆå…³è”çš„é“¾å¼ç»“æ„ï¼‰

æ¥ä¸‹æ¥å®šä¹‰ ADT å•é“¾è¡¨çš„æ•°æ®å’Œæ“ä½œ

å¯¹äºæ¯ä¸€ä¸ªå­˜å‚¨èŠ‚ç‚¹ Node æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå­˜å‚¨ value çš„åœ°æ–¹å’ŒæŒ‡å‘ä¸‹ä¸€èŠ‚ç‚¹çš„æŒ‡é’ˆ next

Node
* value
* next

LinkedList
* Data:
  * root
  * tail
  * length
  * maxsize
* Method:
  * init
  * append: é»˜è®¤åœ¨å°¾èŠ‚ç‚¹å¤„æ·»åŠ æ•°æ®
  * left_append: åœ¨å¤´èŠ‚ç‚¹å¤„æ·»åŠ æ•°æ®
  * find
  * remove
  * iter_node
  * clear

æ¥çœ‹ä¸‹æ—¶é—´å¤æ‚åº¦ï¼š


|é“¾è¡¨æ“ä½œ|	å¹³å‡æ—¶é—´å¤æ‚åº¦|
|--|--|
linked_list.append(value)|	O(1)
linked_list.appendleft(value)|	O(1)
linked_list.find(value)|	O(n)
linked_list.remove(value)|	O(n)

## å¾ªç¯åŒå‘é“¾è¡¨

å•é“¾è¡¨è™½ç„¶ append æ˜¯ O(1)ï¼Œä½†æ˜¯å®ƒçš„ find å’Œ remove éƒ½æ˜¯ O(n)çš„ï¼Œ å› ä¸ºåˆ é™¤ä½ ä¹Ÿéœ€è¦å…ˆæŸ¥æ‰¾ï¼Œè€Œå•é“¾è¡¨æŸ¥æ‰¾åªæœ‰ä¸€ä¸ªæ–¹å¼å°±æ˜¯ä»å¤´æ‰¾åˆ°å°¾ï¼Œä¸­é—´æ‰¾åˆ°æ‰é€€å‡ºã€‚ 

è¿™é‡Œå°±è¦ä½¿ç”¨åˆ°åŒé“¾è¡¨äº†ï¼Œç›¸æ¯”å•é“¾è¡¨æ¥è¯´ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ—¢ä¿å­˜äº†æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼ŒåŒæ—¶è¿˜ä¿å­˜äº†ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚

```python
class Node(object):
    # å¦‚æœèŠ‚ç‚¹å¾ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ __slots__ æ¥èŠ‚çœå†…å­˜ï¼ŒæŠŠå±æ€§ä¿å­˜åœ¨ä¸€ä¸ª tuple è€Œä¸æ˜¯ dict é‡Œ
    # æ„Ÿå…´è¶£å¯ä»¥è‡ªè¡Œæœç´¢  python  __slots__
    __slots__ = ('value', 'prev', 'next')

    def __init__(self, value=None, prev=None, next=None):
        self.value, self.prev, self.next = value, prev, next
```

* åè¿‡æ¥ä»å“ªé‡Œå¼€å§‹å‘¢ï¼Ÿæˆ‘ä»¬åªè¦è®© root çš„ prev æŒ‡å‘ tail èŠ‚ç‚¹ï¼Œä¸å°±ä¸²èµ·æ¥äº†å—ï¼Ÿ
* ç›´æ¥åˆ é™¤èŠ‚ç‚¹ï¼Œå½“ç„¶å¦‚æœç»™çš„æ˜¯ä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦æŸ¥æ‰¾è¿™ä¸ªå€¼åœ¨å“ªä¸ªèŠ‚ç‚¹ï¼Ÿ - ä½†æ˜¯å¦‚æœç»™äº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹¿æ‰ï¼Œç›´æ¥è®©å®ƒçš„å‰åèŠ‚ç‚¹äº’ç›¸æŒ‡è¿‡å»ä¸å°±è¡Œäº†ï¼Ÿå“‡æ¬§ï¼Œåˆ é™¤å°±æ˜¯ O(1) äº†ï¼Œä¸¤æ­¥æ“ä½œå°±è¡Œå•¦

ç›¸å…³æ“ä½œçš„æ—¶é—´å¤æ‚åº¦

|å¾ªç¯åŒç«¯é“¾è¡¨æ“ä½œ|	å¹³å‡æ—¶é—´å¤æ‚åº¦|
|--|--|
cdll.append(value)|	O(1)
cdll.appendleft(value)|	O(1)
cdll.remove(node)ï¼Œæ³¨æ„è¿™é‡Œå‚æ•°æ˜¯ node|	O(1)
cdll.headnode()|	O(1)
cdll.tailnode()|	O(1)

## æ€è€ƒ - å•é“¾è¡¨ $O(1)$ æ—¶é—´å¤æ‚çš„ remove æ“ä½œ

åœ¨è¿™é‡Œï¼Œæ€è€ƒäº†ä¸€ä¸‹å½“è¾“å…¥å‚æ•°ä¸º node çš„æ—¶å€™ï¼Œ remove æ“ä½œçš„æ—¶é—´å¤æ‚åº¦é—®é¢˜

çœ‹ä¸Šå»å¥½åƒåŒå‘é“¾è¡¨å¯ä»¥æå¤§çš„åŠ å¿«é€Ÿåº¦ï¼Œå› ä¸ºåˆ é™¤å¾—æ—¶å€™åªéœ€è¦å¸¸æ•°æ¬¡æ•°çš„æ“ä½œ

ä½†æ˜¯å…¶å®å•å‘é“¾è¡¨ä¹Ÿæœ‰åŒæ ·å¸¸æ•°æ¬¡æ“ä½œçš„ remove æ–¹æ³•

ä¸è¿‡å‰ææ˜¯è¾“å…¥å‚æ•°æ˜¯ node

å…·ä½“æ–¹æ³•å°±æ˜¯æŠŠè¦åˆ é™¤èŠ‚ç‚¹çš„ä¸‹ä¸€èŠ‚ç‚¹æ•°å€¼æ”¾åˆ°è¾“å…¥èŠ‚ç‚¹é‡Œé¢ï¼Œç„¶åæŠŠè¾“å…¥èŠ‚ç‚¹çš„ next æŒ‡å‘è¾“å…¥èŠ‚ç‚¹ä¸‹ä¸€èŠ‚ç‚¹çš„ next

æ‰€ä»¥å°±ç›¸å½“äºå½“æˆ‘è¦åˆ é™¤ä¸€ä¸ª node çš„æ—¶å€™ï¼Œ æˆ‘ä¸ç”¨é€šè¿‡éå†å¾—åˆ°è¯¥èŠ‚ç‚¹çš„ä¸Šä¸€èŠ‚ç‚¹ã€‚æˆ‘å¯ä»¥é€šè¿‡è®©è¾“å…¥èŠ‚ç‚¹çš„ä¸‹ä¸€èŠ‚ç‚¹ä»£æ›¿å®ƒè¢«åˆ é™¤ï¼ŒåŒæ—¶æˆ‘æŠŠè¾“å…¥èŠ‚ç‚¹çš„ä¸‹ä¸€èŠ‚ç‚¹ä¿¡æ¯ä¿å­˜åœ¨æœ¬æ¥è¦åˆ é™¤çš„èŠ‚ç‚¹ä¸Š

> ä¸‹ä¸€èŠ‚ç‚¹ï¼š" ï¼Ÿï¼Ÿï¼Ÿ è¯´å¥½çš„åˆ å®ƒå‘¢ ğŸ˜Š"

```python
# input node
# å…ˆå°†è¾“å…¥èŠ‚ç‚¹çš„ä¸‹ä¸€èŠ‚ç‚¹æ•°å€¼å­˜åˆ°è¾“å…¥èŠ‚ç‚¹
node.value = node.next.value
# å†å°†è¾“å…¥èŠ‚ç‚¹çš„ next æŒ‡å‘è¾“å…¥èŠ‚ç‚¹çš„ä¸‹ä¸€èŠ‚ç‚¹çš„ next
node.next = node.next.next
```

## ç›¸å…³é—®é¢˜

* è¿™é‡Œå•é“¾è¡¨å®ç° insert æ–¹æ³•ã€‚ insert(value, new_value)ï¼Œåœ¨æŸä¸ªå€¼ä¹‹å‰æ’å…¥ä¸€ä¸ªå€¼ã€‚ä½ åŒæ ·éœ€è¦å…ˆæŸ¥æ‰¾ï¼Œæ‰€ä»¥è¿™ä¸ªæ­¥éª¤ä¹Ÿä¸å¤Ÿé«˜æ•ˆã€‚
* python å†…ç½®åº“çš„å“ªäº›æ•°æ®ç»“æ„ä½¿ç”¨åˆ°äº†é“¾å¼ç»“æ„ï¼Ÿ
  * pythonè¯­è¨€æœ¬èº«æ²¡æœ‰å†…ç½®ç”¨åˆ°é“¾å¼ç»“æ„çš„
  * ä½†æ˜¯æœ‰ä¸ªå†…ç½®åº“ä¸­çš„ collections.dequeï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰ç”¨åˆ°äº†é“¾å¼ç»“æ„

## å•é“¾è¡¨å®ç°

```python
# -*- coding: utf-8 -*-
class Node(object):
    '''
    å®šä¹‰å•é“¾è¡¨å­˜å‚¨èŠ‚ç‚¹ Node
    '''
    def __init__(self,value = None,next = None):
    # åˆå§‹åŒ–å‡½æ•°
        self.value,self.next = value,next


class LinkedList(object):
    '''
    å®šä¹‰ä¸€ä¸ªå•é“¾è¡¨
    '''
    def __init__(self,maxsize = None):
    # åˆå§‹åŒ–å‡½æ•°
        # ä¸èƒ½å…è®¸å•é“¾è¡¨æ— é™æ‰©å……
        self.maxsize = maxsize
        # åˆå§‹åŒ–è·ŸèŠ‚ç‚¹ï¼Œå…¶nextä¼šæŒ‡å‘å¤´èŠ‚ç‚¹
        self.root = Node()
        # åˆå§‹åŒ–å°¾èŠ‚ç‚¹ï¼Œå…¶ä¸ºroot.nextèŠ‚ç‚¹
        self.tail = self.root.next
        # åˆå§‹åŒ–å½“å‰å•é“¾è¡¨é•¿åº¦
        self.length = 0

    def __len__(self):
    # len é­”æ³•å‡½æ•°ï¼Œè¿”å›å½“å‰å•é“¾è¡¨é•¿åº¦
        return self.length

    def append(self,value):
    # é»˜è®¤åœ¨å°¾èŠ‚ç‚¹æ·»åŠ æ–°æ•°æ®
        # é¦–å…ˆåˆ¤æ–­å½“å‰å®¹é‡æ˜¯å¦å·²æ»¡
        if self.maxsize is None or self.length > self.maxsize:
            raise Exception('linkedlist is full!')
        tail_node = self.tail
        new_node = Node(value)
        # åˆ¤æ–­å½“å‰å•é“¾è¡¨æ˜¯å¦å·²ç»æœ‰æ•°æ®
        if tail_node is None:
            # å½“å‰å•é“¾è¡¨æ²¡æœ‰æ•°æ®
            self.root.next = new_node
        else :
            # å½“å‰å•é“¾è¡¨å·²å­˜æ•°æ®
            self.tail.next = new_node
        # æ›´æ–°å°¾èŠ‚ç‚¹
        self.tail = new_node
        # æ›´æ–°é•¿åº¦
        self.length += 1

    def left_append(self,value):
    # åœ¨å¤´èŠ‚ç‚¹å¤„æ·»åŠ æ•°æ®
        # åŒï¼Œå…ˆåˆ¤æ–­å®¹é‡æ˜¯å¦å·²æ»¡
        if self.maxsize is None and self.length > self.maxsize:
            raise Exception('linked list is full!')
        new_node = Node(value)
        # åˆ¤æ–­å½“å‰å•é“¾è¡¨æ˜¯å¦å­˜æ•°æ®
        head_node = self.root.next
        if head_node is None:
            # æ²¡æœ‰å­˜æ•°æ®
            self.root.next = new_node
            self.tail = new_node
        else:
            # å·²ç»å­˜æ•°æ®
            self.root.next = new_node
            new_node.next = head_node
        # æ›´æ–°é•¿åº¦
        self.length += 1

    def iter_node(self):
    # nodeèŠ‚ç‚¹è¿­ä»£å™¨
        current_node = self.root.next
        while current_node is not self.tail:
            # åªè¦æ²¡åˆ°å°¾èŠ‚ç‚¹
            yield current_node
            current_node = current_node.next
        # æœ€åä¹Ÿè¦æŠŠå°¾èŠ‚ç‚¹è¿”å›
        yield current_node

    def __iter__(self):
    # å•é“¾è¡¨æ•°å€¼è¿­ä»£å™¨
        for node in self.iter_node():
            yield node.value

    
    def find(self,value):
    # æŸ¥æ‰¾ç›¸åº”æ•°å€¼ï¼Œè¿”å›åºåˆ—å·
        index = 0
        for node in self.iter_node():
            # éå†æŸ¥æ‰¾
            if node is not None and node.value == value:
                return index
            index +=1
        # æ²¡æ‰¾åˆ°
        return -1

    def remove(self,value):
    # åˆ é™¤ä¸€ä¸ªåˆ¶å®šæ•°å€¼çš„èŠ‚ç‚¹
        pre_node = self.root
        current_node = self.root.next
        for current_node in self.iter_node():
            if current_node.value == value:
                # æ‰¾åˆ°å¯¹åº”æ•°å­—
                if current_node == self.tail:
                    # å¦‚æœæ˜¯å°¾èŠ‚ç‚¹
                    pre_node.next = None
                    del current_node
                    self.tail = pre_node
                else:
                    pre_node.next = current_node.next
                    del current_node
                # æ›´æ–°é•¿åº¦
                self.length -= 1
                return 1
            pre_node = current_node
        return -1

    def clear(self):
    # æ¸…ç©ºå•é“¾è¡¨
        self.root.next = None
        self.tail = self.root.next
        self.length = 0

def test_LinkedList():
# å•å…ƒæµ‹è¯•
    linkedlist = LinkedList(3)

    linkedlist.append(1)
    linkedlist.append(2)
    linkedlist.append(3)

    assert linkedlist.find(2) == 1

    assert linkedlist.remove(2) == 1

    assert linkedlist.find(2) == -1

    linkedlist.left_append(20)
    assert linkedlist.find(20) == 0

    assert linkedlist.find(1) == 1
    
    linkedlist.append(2)

    linkedlist.clear()

    assert linkedlist.find(2) == -1

    assert len(linkedlist) == 0
```